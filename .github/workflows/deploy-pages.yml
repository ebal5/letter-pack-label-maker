name: Deploy to GitHub Pages

# ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ã®ãƒˆãƒªã‚¬ãƒ¼è¨­å®š
on:
  # mainãƒ–ãƒ©ãƒ³ãƒã¸ã®pushæ™‚ã«å®Ÿè¡Œ
  push:
    branches: [ main ]
    paths:
      - 'index_static.html'
      - 'poc_pyodide.html'
      - 'STATIC_VERSION.md'
      - 'README.md'
  # æ‰‹å‹•å®Ÿè¡Œã‚‚å¯èƒ½
  workflow_dispatch:

# GitHub Pagesã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã«å¿…è¦ãªæ¨©é™è¨­å®š
permissions:
  contents: read
  pages: write
  id-token: write

# åŒæ™‚å®Ÿè¡Œã®åˆ¶å¾¡ï¼ˆè¤‡æ•°ã®ãƒ‡ãƒ—ãƒ­ã‚¤ãŒåŒæ™‚ã«å®Ÿè¡Œã•ã‚Œãªã„ã‚ˆã†ã«ã™ã‚‹ï¼‰
concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  # é™çš„ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ãƒ“ãƒ«ãƒ‰ï¼ˆæº–å‚™ï¼‰ã™ã‚‹ã‚¸ãƒ§ãƒ–
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Setup Pages
        uses: actions/configure-pages@v4

      - name: Create deployment directory
        run: |
          mkdir -p _site
          cp index_static.html _site/index.html
          cp poc_pyodide.html _site/poc_pyodide.html
          cp STATIC_VERSION.md _site/STATIC_VERSION.md
          cp README.md _site/README.md
          echo "âœ… ãƒ‡ãƒ—ãƒ­ã‚¤ç”¨ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æº–å‚™ã—ã¾ã—ãŸ"
          ls -la _site/

      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: '_site'

  # GitHub Pagesã¸ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ã‚¸ãƒ§ãƒ–
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4

      - name: Show deployment URL
        run: |
          echo "ğŸš€ ãƒ‡ãƒ—ãƒ­ã‚¤å®Œäº†!"
          echo "ğŸ“„ å…¬é–‹URL: ${{ steps.deployment.outputs.page_url }}"
